<UserControl x:Class="WhatsAppSimHubPlugin.UI.Tabs.ContactsTab"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:styles="clr-namespace:SimHub.Plugins.Styles;assembly=SimHub.Plugins">

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <Grid Margin="20">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Manage Allowed Contacts List -->
            <TextBlock Grid.Row="0" Text="Manage Allowed Contacts List"
                       FontSize="18"
                       FontWeight="Bold"
                       Foreground="#00BCD4"
                       Margin="0,0,0,5"/>
            <Border Grid.Row="0" Height="1" Background="#00BCD4" Margin="0,25,0,15"/>

            <!-- Add from Google Contacts -->
            <Border Grid.Row="1" Background="#2D2D30" Padding="15" CornerRadius="8" Margin="0,0,0,15">
                <StackPanel>
                    <TextBlock Text="ðŸ“‡ Add from Google Contacts"
                              FontSize="16"
                              FontWeight="SemiBold"
                              Foreground="#D4D4D4"
                              Margin="0,0,0,10"/>

                    <!-- Connect Button + Status -->
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                        <styles:SHButtonPrimary x:Name="GoogleConnectButton"
                               Content="ðŸ”— Connect Google"
                               Background="#4285F4"
                               Foreground="White"
                               Padding="15,6"
                               Height="32"
                               FontSize="13"
                               FontWeight="SemiBold"
                               ToolTip="Connect to Google Contacts"/>

                        <Ellipse x:Name="GoogleStatusIndicator"
                                 Width="12" Height="12"
                                 Fill="#C42B1C"
                                 Margin="15,0,8,0"
                                 VerticalAlignment="Center"/>

                        <TextBlock x:Name="GoogleStatusText"
                                   Text="Not connected"
                                   Foreground="#858585"
                                   FontSize="12"
                                   VerticalAlignment="Center"/>
                    </StackPanel>

                    <!-- ComboBox + Refresh + Add -->
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <ComboBox x:Name="GoogleContactsComboBox"
                                 Grid.Column="0"
                                 IsEnabled="False"
                                 IsEditable="True"
                                 IsTextSearchEnabled="False"
                                 StaysOpenOnEdit="True"
                                 DisplayMemberPath="DisplayText"
                                 Background="#252526"
                                 Foreground="#D4D4D4"
                                 BorderBrush="#3E3E42"
                                 Height="32"
                                 Margin="0,0,10,0"
                                 FontSize="13"
                                 ToolTip="Type to search contacts"/>

                        <styles:SHButtonPrimary x:Name="GoogleRefreshButton"
                               Grid.Column="1"
                               Content="ðŸ”„ Refresh"
                               IsEnabled="False"
                               Background="#007ACC"
                               Foreground="White"
                               Width="110"
                               Height="32"
                               FontSize="13"
                               FontWeight="SemiBold"
                               Margin="0,0,10,0"
                               ToolTip="Refresh Google contacts"/>

                        <styles:SHButtonPrimary x:Name="GoogleAddButton"
                               Grid.Column="2"
                               Content="âž• Add"
                               IsEnabled="False"
                               Background="#0E7A0D"
                               Foreground="White"
                               Padding="15,6"
                               FontSize="13"
                               FontWeight="SemiBold"/>
                    </Grid>
                </StackPanel>
            </Border>

            <!-- Manual Add -->
            <Border Grid.Row="2" Background="#2D2D30" Padding="15" CornerRadius="8" Margin="0,0,0,15">
                <StackPanel>
                    <TextBlock Text="âž• Add Contact Manually"
                              FontSize="16"
                              FontWeight="SemiBold"
                              Foreground="#D4D4D4"
                              Margin="0,0,0,10"/>

                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <TextBox x:Name="ManualNameTextBox"
                                Grid.Row="0"
                                Grid.Column="0"
                                Background="#252526"
                                Foreground="#D4D4D4"
                                BorderBrush="#3E3E42"
                                Height="40"
                                Margin="0,0,10,0"
                                Padding="10,8"
                                FontSize="13"
                                VerticalContentAlignment="Center"
                                VerticalScrollBarVisibility="Disabled"
                                HorizontalScrollBarVisibility="Disabled"/>

                        <TextBox x:Name="ManualNumberTextBox"
                                Grid.Row="0"
                                Grid.Column="1"
                                Background="#252526"
                                Foreground="#D4D4D4"
                                BorderBrush="#3E3E42"
                                Height="40"
                                Margin="0,0,10,0"
                                Padding="10,8"
                                FontSize="13"
                                VerticalContentAlignment="Center"
                                VerticalScrollBarVisibility="Disabled"
                                HorizontalScrollBarVisibility="Disabled"/>

                        <styles:SHButtonPrimary x:Name="AddManualButton"
                               Grid.Row="0"
                               Grid.Column="2"
                               Content="âž• Add"
                               Background="#0E7A0D"
                               Foreground="White"
                               Padding="15,6"
                               FontSize="13"
                               FontWeight="SemiBold"/>

                        <!-- Hints -->
                        <TextBlock Grid.Row="1"
                                   Grid.Column="0"
                                   Text="Name of contact"
                                   Foreground="#858585"
                                   FontSize="10"
                                   Margin="0,4,10,0"/>

                        <TextBlock Grid.Row="1"
                                   Grid.Column="1"
                                   Text="Format: +[country code][number] (e.g. +1555123456, +44791234567)"
                                   Foreground="#858585"
                                   FontSize="10"
                                   Margin="0,4,10,0"/>
                    </Grid>
                </StackPanel>
            </Border>

            <!-- Allowed Contacts Header -->
            <Border Grid.Row="3" Background="#2D2D30" Padding="15,10,15,5" CornerRadius="8,8,0,0">
                <TextBlock Text="ðŸ“‹ Allowed Contacts"
                          FontSize="16"
                          FontWeight="SemiBold"
                          Foreground="#D4D4D4"/>
            </Border>

            <!-- Contacts DataGrid -->
            <Border Grid.Row="4" Background="#252526" Padding="0" CornerRadius="0,0,8,8">
                <DataGrid x:Name="ContactsDataGrid"
                             AutoGenerateColumns="False"
                             CanUserAddRows="False"
                             CanUserDeleteRows="False"
                             CanUserReorderColumns="False"
                             CanUserResizeRows="False"
                             CanUserSortColumns="True"
                             Background="#252526"
                             RowBackground="#2D2D30"
                             AlternatingRowBackground="#252526"
                             BorderThickness="0"
                             GridLinesVisibility="None"
                             HeadersVisibility="Column"
                             SelectionMode="Single"
                             IsReadOnly="False">

                        <DataGrid.ColumnHeaderStyle>
                            <Style TargetType="DataGridColumnHeader">
                                <Setter Property="Background" Value="#3E3E42"/>
                                <Setter Property="Foreground" Value="#D4D4D4"/>
                                <Setter Property="FontWeight" Value="SemiBold"/>
                                <Setter Property="Padding" Value="10,8"/>
                                <Setter Property="BorderThickness" Value="0,0,0,1"/>
                                <Setter Property="BorderBrush" Value="#858585"/>
                            </Style>
                        </DataGrid.ColumnHeaderStyle>

                        <!-- Row Style - Remover highlight azul ao selecionar -->
                        <DataGrid.RowStyle>
                            <Style TargetType="DataGridRow">
                                <Setter Property="Background" Value="Transparent"/>
                                <Setter Property="Foreground" Value="#D4D4D4"/>
                                <Style.Triggers>
                                    <Trigger Property="IsSelected" Value="True">
                                        <Setter Property="Background" Value="Transparent"/>
                                        <Setter Property="Foreground" Value="#D4D4D4"/>
                                    </Trigger>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="#3E3E42"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </DataGrid.RowStyle>

                        <!-- Cell Style - Remover highlight azul nas cÃ©lulas -->
                        <DataGrid.CellStyle>
                            <Style TargetType="DataGridCell">
                                <Setter Property="Background" Value="Transparent"/>
                                <Setter Property="BorderThickness" Value="0"/>
                                <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
                                <Style.Triggers>
                                    <Trigger Property="IsSelected" Value="True">
                                        <Setter Property="Background" Value="Transparent"/>
                                        <Setter Property="Foreground" Value="#D4D4D4"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </DataGrid.CellStyle>

                        <DataGrid.Columns>
                            <!-- Name Column -->
                            <DataGridTextColumn Header="Name"
                                              Binding="{Binding Name}"
                                              Width="*"
                                              IsReadOnly="True">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Foreground" Value="#D4D4D4"/>
                                        <Setter Property="Padding" Value="10,8"/>
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>

                            <!-- Number Column -->
                            <DataGridTextColumn Header="Number"
                                              Binding="{Binding FormattedNumber}"
                                              Width="150"
                                              IsReadOnly="True">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Foreground" Value="#D4D4D4"/>
                                        <Setter Property="Padding" Value="10,8"/>
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>

                            <!-- VIP Checkbox Column -->
                            <DataGridTemplateColumn Header="â­ VIP" Width="80">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <styles:SHToggleCheckbox x:Name="VipCheckbox"
                                                 IsChecked="{Binding IsVip, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                 HorizontalAlignment="Center"
                                                 VerticalAlignment="Center"
                                                 Checked="VipCheckbox_Changed"
                                                 Unchecked="VipCheckbox_Changed"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>

                            <!-- Actions Column -->
                            <DataGridTemplateColumn Header="Actions" Width="100">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <styles:SHButtonPrimary x:Name="RemoveButton"
                                               Content="ðŸ—‘ï¸ Remove"
                                               Tag="{Binding}"
                                               Background="#C42B1C"
                                               Foreground="White"
                                               BorderThickness="0"
                                               Padding="8,4"
                                               FontSize="11"
                                               Margin="5,2"
                                               Loaded="RemoveContactButton_Loaded"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                </DataGrid>
            </Border>
        </Grid>
    </ScrollViewer>
</UserControl>
